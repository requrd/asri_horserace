from horseview.horsemodel import sesobj, ReturninfoData
import sys, codecs

file = sys.argv[1]
print(file)

# ここからファイル操作
with codecs.open(file, "r", "shift_jisx0213") as f:
    for line in f:
        racekey = line[0:8]
        win1_num = line[8:10]
        win1_ret = line[10:17]
        win2_num = line[17:19]
        win2_ret = line[19:26]
        win3_num = line[26:28]
        win3_ret = line[28:35]
        place1_num = line[35:37]
        place1_ret = line[37:44]
        place2_num = line[44:46]
        place2_ret = line[46:53]
        place3_num = line[53:55]
        place3_ret = line[55:62]
        place4_num = line[62:64]
        place4_ret = line[64:71]
        place5_num = line[71:73]
        place5_ret = line[73:80]
        wakuren1_num1 = line[80:81]
        wakuren1_num2 = line[81:82]
        wakuren1_ret = line[82:89]
        wakuren2_num1 = line[89:90]
        wakuren2_num2 = line[90:91]
        wakuren2_ret = line[91:98]
        wakuren3_num1 = line[98:99]
        wakuren3_num2 = line[99:100]
        wakuren3_ret = line[100:107]
        umaren1_num1 = line[107:109]
        umaren1_num2 = line[109:111]
        umaren1_ret = line[111:119]
        umaren2_num1 = line[119:121]
        umaren2_num2 = line[121:123]
        umaren2_ret = line[123:131]
        umaren3_num1 = line[131:133]
        umaren3_num2 = line[133:135]
        umaren3_ret = line[135:143]
        wide1_num1 = line[143:145]
        wide1_num2 = line[145:147]
        wide1_ret = line[147:155]
        wide2_num1 = line[155:157]
        wide2_num2 = line[157:159]
        wide2_ret = line[159:167]
        wide3_num1 = line[167:169]
        wide3_num2 = line[169:171]
        wide3_ret = line[171:179]
        wide4_num1 = line[179:181]
        wide4_num2 = line[181:183]
        wide4_ret = line[183:191]
        wide5_num1 = line[191:193]
        wide5_num2 = line[193:195]
        wide5_ret = line[195:203]
        wide6_num1 = line[203:205]
        wide6_num2 = line[205:207]
        wide6_ret = line[207:215]
        wide7_num1 = line[215:217]
        wide7_num2 = line[217:219]
        wide7_ret = line[219:227]
        umatan1_num1 = line[227:229]
        umatan1_num2 = line[229:231]
        umatan1_ret = line[231:239]
        umatan2_num1 = line[239:241]
        umatan2_num2 = line[241:243]
        umatan2_ret = line[243:251]
        umatan3_num1 = line[251:253]
        umatan3_num2 = line[253:255]
        umatan3_ret = line[255:263]
        umatan4_num1 = line[263:265]
        umatan4_num2 = line[265:267]
        umatan4_ret = line[267:275]
        umatan5_num1 = line[275:277]
        umatan5_num2 = line[277:279]
        umatan5_ret = line[279:287]
        umatan6_num1 = line[287:289]
        umatan6_num2 = line[289:291]
        umatan6_ret = line[291:299]
        sanrenpuku1_num1 = line[299:301]
        sanrenpuku1_num2 = line[301:303]
        sanrenpuku1_num3 = line[303:305]
        sanrenpuku1_ret = line[305:313]
        sanrenpuku2_num1 = line[313:315]
        sanrenpuku2_num2 = line[315:317]
        sanrenpuku2_num3 = line[317:319]
        sanrenpuku2_ret = line[319:327]
        sanrenpuku3_num1 = line[327:329]
        sanrenpuku3_num2 = line[329:331]
        sanrenpuku3_num3 = line[331:333]
        sanrenpuku3_ret = line[333:341]
        sanrentan1_num1 = line[341:343]
        sanrentan1_num2 = line[343:345]
        sanrentan1_num3 = line[345:347]
        sanrentan1_ret = line[347:356]
        sanrentan2_num1 = line[356:358]
        sanrentan2_num2 = line[358:360]
        sanrentan2_num3 = line[360:362]
        sanrentan2_ret = line[362:371]
        sanrentan3_num1 = line[371:373]
        sanrentan3_num2 = line[373:375]
        sanrentan3_num3 = line[375:377]
        sanrentan3_ret = line[377:386]
        sanrentan4_num1 = line[386:388]
        sanrentan4_num2 = line[388:390]
        sanrentan4_num3 = line[390:392]
        sanrentan4_ret = line[392:401]
        sanrentan5_num1 = line[401:403]
        sanrentan5_num2 = line[403:405]
        sanrentan5_num3 = line[405:407]
        sanrentan5_ret = line[407:416]
        sanrentan6_num1 = line[416:418]
        sanrentan6_num2 = line[418:420]
        sanrentan6_num3 = line[420:422]
        sanrentan6_ret = line[422:431]

        # ここからDB操作
        new_retinfo = ReturninfoData(
            racekey=racekey,
            win1_num=win1_num,
            win1_ret=win1_ret,
            win2_num=win2_num,
            win2_ret=win2_ret,
            win3_num=win3_num,
            win3_ret=win3_ret,
            place1_num=place1_num,
            place1_ret=place1_ret,
            place2_num=place2_num,
            place2_ret=place2_ret,
            place3_num=place3_num,
            place3_ret=place3_ret,
            place4_num=place4_num,
            place4_ret=place4_ret,
            place5_num=place5_num,
            place5_ret=place5_ret,
            wakuren1_num1=wakuren1_num1,
            wakuren1_num2=wakuren1_num2,
            wakuren1_ret=wakuren1_ret,
            wakuren2_num1=wakuren2_num1,
            wakuren2_num2=wakuren2_num2,
            wakuren2_ret=wakuren2_ret,
            wakuren3_num1=wakuren3_num1,
            wakuren3_num2=wakuren3_num2,
            wakuren3_ret=wakuren3_ret,
            umaren1_num1=umaren1_num1,
            umaren1_num2=umaren1_num2,
            umaren1_ret=umaren1_ret,
            umaren2_num1=umaren2_num1,
            umaren2_num2=umaren2_num2,
            umaren2_ret=umaren2_ret,
            umaren3_num1=umaren3_num1,
            umaren3_num2=umaren3_num2,
            umaren3_ret=umaren3_ret,
            wide1_num1=wide1_num1,
            wide1_num2=wide1_num2,
            wide1_ret=wide1_ret,
            wide2_num1=wide2_num1,
            wide2_num2=wide2_num2,
            wide2_ret=wide2_ret,
            wide3_num1=wide3_num1,
            wide3_num2=wide3_num2,
            wide3_ret=wide3_ret,
            wide4_num1=wide4_num1,
            wide4_num2=wide4_num2,
            wide4_ret=wide4_ret,
            wide5_num1=wide5_num1,
            wide5_num2=wide5_num2,
            wide5_ret=wide5_ret,
            wide6_num1=wide6_num1,
            wide6_num2=wide6_num2,
            wide6_ret=wide6_ret,
            wide7_num1=wide7_num1,
            wide7_num2=wide7_num2,
            wide7_ret=wide7_ret,
            umatan1_num1=umatan1_num1,
            umatan1_num2=umatan1_num2,
            umatan1_ret=umatan1_ret,
            umatan2_num1=umatan2_num1,
            umatan2_num2=umatan2_num2,
            umatan2_ret=umatan2_ret,
            umatan3_num1=umatan3_num1,
            umatan3_num2=umatan3_num2,
            umatan3_ret=umatan3_ret,
            umatan4_num1=umatan4_num1,
            umatan4_num2=umatan4_num2,
            umatan4_ret=umatan4_ret,
            umatan5_num1=umatan5_num1,
            umatan5_num2=umatan5_num2,
            umatan5_ret=umatan5_ret,
            umatan6_num1=umatan6_num1,
            umatan6_num2=umatan6_num2,
            umatan6_ret=umatan6_ret,
            sanrenpuku1_num1=sanrenpuku1_num1,
            sanrenpuku1_num2=sanrenpuku1_num2,
            sanrenpuku1_num3=sanrenpuku1_num3,
            sanrenpuku1_ret=sanrenpuku1_ret,
            sanrenpuku2_num1=sanrenpuku2_num1,
            sanrenpuku2_num2=sanrenpuku2_num2,
            sanrenpuku2_num3=sanrenpuku2_num3,
            sanrenpuku2_ret=sanrenpuku2_ret,
            sanrenpuku3_num1=sanrenpuku3_num1,
            sanrenpuku3_num2=sanrenpuku3_num2,
            sanrenpuku3_num3=sanrenpuku3_num3,
            sanrenpuku3_ret=sanrenpuku3_ret,
            sanrentan1_num1=sanrentan1_num1,
            sanrentan1_num2=sanrentan1_num2,
            sanrentan1_num3=sanrentan1_num3,
            sanrentan1_ret=sanrentan1_ret,
            sanrentan2_num1=sanrentan2_num1,
            sanrentan2_num2=sanrentan2_num2,
            sanrentan2_num3=sanrentan2_num3,
            sanrentan2_ret=sanrentan2_ret,
            sanrentan3_num1=sanrentan3_num1,
            sanrentan3_num2=sanrentan3_num2,
            sanrentan3_num3=sanrentan3_num3,
            sanrentan3_ret=sanrentan3_ret,
            sanrentan4_num1=sanrentan4_num1,
            sanrentan4_num2=sanrentan4_num2,
            sanrentan4_num3=sanrentan4_num3,
            sanrentan4_ret=sanrentan4_ret,
            sanrentan5_num1=sanrentan5_num1,
            sanrentan5_num2=sanrentan5_num2,
            sanrentan5_num3=sanrentan5_num3,
            sanrentan5_ret=sanrentan5_ret,
            sanrentan6_num1=sanrentan6_num1,
            sanrentan6_num2=sanrentan6_num2,
            sanrentan6_num3=sanrentan6_num3,
            sanrentan6_ret=sanrentan6_ret,
        )
        sesobj.add(new_retinfo)

sesobj.commit()
